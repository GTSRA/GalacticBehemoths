namespace = gts_skadi_potral

country_event = {#球生成考古
	id = gts_skadi_potral.01
	picture = GFX_evt_drifting_gateway
	title = gts_skadi_potral.01.name
	desc = gts_skadi_potral.01.desc
	show_sound = event_ghost_town
	is_triggered_only = yes
	trigger = {
		NOR = {
			has_global_flag = skadi_started
			has_country_flag = skadi_intro
		}
		is_ai = no
	}
	immediate = {
		random_owned_planet = {
			limit = {
				NOT = { exists = archaeological_site }
			}
			create_archaeological_site = site_skadi_potral
			owner = {
				set_country_flag = skadi_intro
				set_global_flag = skadi_started
			}
		}
	}
	option = {
		name = CURIOUS
	}
}

fleet_event = {#飞柔软的头发里边
	id = gts_skadi_potral.02
	title = gts_skadi_potral.02.name
	desc = gts_skadi_potral.02.desc
	picture = gts_skadi_potral.02
	show_sound = event_administrative_work
	archaeology = yes
	is_triggered_only = yes
	immediate = {
		from = { set_site_progress_locked = yes }
	}
	after = {
		from = { set_site_progress_locked = no }
	}
	option = {
		name = gts_skadi_potral.02a
        owner = {
			add_resource = { alloys = 2500 }
		}
	}
}
fleet_event = { #石碑1
	id = gts_skadi_potral.03
	title = gts_skadi_potral.03.name
	desc = gts_skadi_potral.03.desc
	picture = gts_skadi_potral.03
	show_sound = event_administrative_work
	archaeology = yes
	is_triggered_only = yes
    immediate = {
		from = { set_site_progress_locked = yes }
	}
	after = {
		from = { set_site_progress_locked = no }
	}
	option = {
		name = gts_skadi_potral.03a
        owner = {
			add_modifier = {
				modifier = psionics_stone_monuments
			}
            add_resource = {
				physics_research = 114514
			}
		}
	}
}
fleet_event = { #石碑2
	id = gts_skadi_potral.04
	title = gts_skadi_potral.04.name
	desc = gts_skadi_potral.04.desc
	picture = gts_skadi_potral.04
	show_sound = event_air_raid_siren
	archaeology = yes
	is_triggered_only = yes
    option = {
		name = gts_skadi_potral.04a
		owner = {
			add_modifier = {
				modifier = final_city_resist
			}			
		}	
	}
}
fleet_event = {#吃科学家
	id = gts_skadi_potral.05
	title = gts_skadi_potral.05.name
	desc = gts_skadi_potral.05.desc
	picture = gts_skadi_potral.05
	show_sound = event_red_alert
	archaeology = yes
	is_triggered_only = yes
    immediate = {
		from = { set_site_progress_locked = yes }
		leader = {
			save_event_target_as = skadi_eat_leader
		}
	}
	after = {
		from = { set_site_progress_locked = no }
	}
	option = {
		name = gts_skadi_potral.05a
		event_target:skadi_eat_leader = {
			hidden_effect = {
				kill_leader = {
					show_notification = yes
				}
			}
		}	
	}
}
fleet_event = {#狠狠地撅
	id = gts_skadi_potral.06
	title = gts_skadi_potral.06.name
	desc = gts_skadi_potral.06.desc
	picture = gts_skadi_potral.06
	show_sound = event_administrative_work
	archaeology = yes
	is_triggered_only = yes
    immediate = {
		from = { set_site_progress_locked = yes }
	}
	after = {
		from = { set_site_progress_locked = no }
	}
	option = {
		name = gts_skadi_potral.06a
		owner = {
			every_owned_leader = {
				add_experience = 500
			}
			country_event = {
				id = gts_skadi_meet.01
			}
		}
	}
}

fleet_event = {#抱回家
	id = gts_skadi_potral.07
	title = gts_skadi_potral.07.name
	desc = gts_skadi_potral.07.desc
	picture = gts_skadi_potral.07
	show_sound = event_radio_chatter
	archaeology = yes
	is_triggered_only = yes
	immediate = {
		from = { set_site_progress_locked = yes }
		owner = {#给巨像
			add_tech_progress = {
				tech = tech_pk_whaletrap
				progress = 0.5
			}
			every_owned_leader = {
				add_experience = 1000
			}
		}
	}
	after = {
		from = { set_site_progress_locked = no }
	}
	option = {#斯卡蒂传奇英杰
		name = gts_skadi_potral.07a
		owner = {
			country_event = { 
				id = gts_skadi_paragon.01
			}
		}	
	}
	option = {#缩小激素
		name = gts_skadi_potral.07b
		allow = {
			owner = {
				has_technology = tech_pk_gts_shrink
			}
		}
		owner = {
			country_event = { id = gts_skadi_paragon.01 days = 7 }
			country_event = { id = gts_skadi_potral.09 }
		}
	}
}

country_event = {#缩小成功
	id = gts_skadi_potral.09
	title = gts_skadi_potral.09.name
	desc = gts_skadi_potral.09.desc
	is_triggered_only = yes
	picture = skadi_shrunk
    option = {
		name = gts_skadi_potral.09a
		country_event = {
			id = gts_skadi_potral.10
		}
		set_global_flag = skadi_shrunk
	}
}

country_event = {#天降虎鲸
	id = gts_skadi_potral.10
	title = gts_skadi_potral.10.name
	desc = gts_skadi_potral.10.desc
	is_triggered_only = yes
	picture = skadi_fall
	show_sound = event_super_explosion
	trigger = {
		NOT = {
			has_global_flag = skadi_shrunk
			has_global_flag = skadi_no_shrunk
		}
	}

	option = {
		name = gts_skadi_potral.10a
		capital_scope = {
			while = { #测试能运行
				count = 100
				random_owned_pop_group = {
					kill_single_pop = yes
				}
			}			
		}
		hidden_effect = {
			capital_scope = {
				add_deposit = d_skadi_debris
				add_deposit = d_skadi_breasts
				add_deposit = d_skadi_abdomen
				add_deposit = d_skadi_virgin				
			}
		}	
	}
	option = {
		name = gts_skadi_potral.10b
		capital_scope = {
			while = {
				count = 100
				random_owned_pop_group = {
					kill_single_pop = yes
				}
			}
		}
		hidden_effect = {
			capital_scope = {
				add_deposit = d_skadi_debris
				add_deposit = d_skadi_breasts
				add_deposit = d_skadi_abdomen
				add_deposit = d_skadi_virgin
			}
		}	
	}
	option = {
		name = gts_skadi_potral.10c
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
		hidden_effect = {
			capital_scope = {
				add_deposit = d_skadi_debris
				add_deposit = d_skadi_breasts
				add_deposit = d_skadi_abdomen
				add_deposit = d_skadi_virgin
				while = {
					count = 100
					random_owned_pop_group = {
						kill_single_pop = yes
					}
				}
			}
		}		
	}
}

country_event = {#后来才研发缩小激素
	id = gts_skadi_potral.11
	title = gts_skadi_potral.11.name
	desc = gts_skadi_potral.11.desc
	is_triggered_only = yes
	picture = skadi_confused
	trigger = {
		AND = {
			has_technology = tech_pk_gts_shrink
			has_country_flag = skadi_owned
		}
		NOT = {
			has_global_flag = skadi_shrunk
			has_global_flag = skadi_no_shrunk
		}
	}
    option = {
		name = skadi_portal.11a
		country_event = {
			id = gts_skadi_potral.09
		}
	}
	option = { #拒绝在后面更新记得改
		name = skadi_portal.11b
		set_global_flag = skadi_no_shrunk
	}
}

namespace = gts_skadi_meet
country_event = {#穿过去遇见skadi
	id = gts_skadi_meet.01
	title = gts_skadi_meet.01.name
	desc = gts_skadi_meet.01.desc
	picture = gts_skadi_potral.06
	is_triggered_only = yes
	option = {
		name = gts_skadi_meet.01a
		hidden_effect = {
			country_event = {
				id = gts_skadi_meet.02
			}
		}
	}
}
country_event = {#通讯画面
	id = gts_skadi_meet.02
	title = gts_skadi_meet.02.title
	desc = gts_skadi_meet.02.desc
	is_triggered_only = yes
	diplomatic = yes #外教界面
	picture_event_data = {
		portrait = skadi01
		room = "crisis_room"
	}
	option = {#这就是泰拉，听斯卡蒂说
		name = skadi_answer01
		is_dialog_only = yes
		response_text = skadi_answer01a
	}
	option = {
		name = skadi_answer02
		is_dialog_only = yes
		response_text = skadi_answer02a
	}
	option = {
		name = skadi_answer03
		is_dialog_only = yes
		response_text = skadi_answer03a
	}
	option = {
		name = skadi_answer04
		is_dialog_only = yes
		response_text = skadi_answer04a
	}
	option = {
		name = skadi_answer05
		is_dialog_only = yes
		response_text = skadi_answer05a
	}
	option = {
		name = skadi_answer06
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
		is_dialog_only = yes
		response_text = skadi_answer06a
	}
	option = {#结束对话
		name = skadi_answer666
	}
}


namespace = gts_skadi_paragon
country_event = { # spiritualist 1
	id = gts_skadi_paragon.01
	title = "gts_skadi_paragon.01.name"
	desc = "gts_skadi_paragon.01.desc"
	show_sound = event_mystic_reveal
	is_triggered_only = yes

	picture = GFX_leader_recruitment_bg_legendary_skrand
	auto_opens = no
	event_window_type = leader_recruit
	notification_event_icon = "message_leader_recruitment_skadi"

	immediate = {
		legendary_gts_leader_creator = {
			LEADER_PORTRAIT = skadi02
			CLASS = commander
			NAME = skadi_leader
			LEVEL = 1
			AGE = 17
			GENDER = female
			ETHIC = spiritualist
			IMMORTAL = yes
			DESC = skadi_leader_desc
			CATCH_PHRASE = skadi_catch_phrase
			EVENT_LEADER = no
			RANDOMIZE_TRAITS = no
			TRAIT1 = trait_ruler_skadi_trait1
			TRAIT2 = trait_ruler_skadi_trait2
			TRAIT3 = trait_ruler_skadi_trait3
			TRAIT4 = trait_ruler_skadi_trait4
			TRAIT5 = subclass_commander_sadsong
			TRAIT6 = leader_trait_Ultra
			TARGET = gts_skadi
		}
	}
	picture_event_data = {
		portrait = event_target:gts_leader
		room = "crisis_room"
	}
	option = {
		name = DISMISS
		tag = dismiss_leader
	}
	option = {
		name = gts_skadi_paragon.a
		response_text = gts_skadi_paragon.a.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_paragon.b
		response_text = gts_skadi_paragon.b.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_paragon.c
		response_text = gts_skadi_paragon.c.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_paragon.d
		response_text = gts_skadi_paragon.d.response
		is_dialog_only = yes
		event_target:gts_leader = {
			add_trait = {
				trait = skadi_leader_trait_cute
			}
		}
	}
	option = {
		name = gts_skadi_paragon.e
		response_text = gts_skadi_paragon.e.response
		is_dialog_only = yes
	}
	option = {
		name = HIRE
		tag = hire_leader
		hidden_effect = {
			set_country_flag = skadi_owned #国家标记
			legendary_gts_leader_hire_effect = yes
			save_global_event_target_as = skadi_country #后面还要用
		}
	}
	after = {
		random_owned_leader = {
			limit = {
				has_leader_flag = gts_skadi
			}
			add_skill_without_trait_selection = 4
		}
	}
}

#斯卡蒂堂堂复活
country_event = {
	id = gts_skadi_paragon.02
	title = gts_skadi_paragon.02.name
	desc = gts_skadi_paragon.02.desc
	is_triggered_only = yes
	picture = skadi_revival
	show_sound = event_celebration
	trigger = {
		has_country_flag = skadi_owned
		NOT = {
			any_owned_leader = {
				has_leader_flag = gts_skadi
			}
		}
	}
	immediate = {
		legendary_gts_leader_creator = {
			LEADER_PORTRAIT = skadi02
			CLASS = commander
			NAME = skadi_leader
			LEVEL = 1
			AGE = 17
			GENDER = female
			IMMORTAL = yes
			ETHIC = spiritualist
			DESC = skadi_leader_desc
			CATCH_PHRASE = skadi_catch_phrase
			RANDOMIZE_TRAITS = no
			TARGET = gts_skadi
			TRAIT1 = subclass_commander_sadsong
			TRAIT2 = leader_trait_Ultra
			TRAIT3 = trait_ruler_skadi_trait1
			TRAIT4 = trait_ruler_skadi_trait2
			TRAIT5 = trait_ruler_skadi_trait3
			TRAIT6 = trait_ruler_skadi_trait4
		}
	}
	option = {
		name = gts_skadi_paragon.02a
	}
	option = {
		name = gts_skadi_paragon.02b
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
	}
	after = {
		skadi_hire_leader = yes
		random_owned_leader = {
			limit = {
				has_leader_flag = gts_skadi
			}
			add_skill_without_trait_selection = 4
		}
	}
}


namespace = gts_skadi_shroud
country_event = {
	#准备签契约
	id = gts_skadi_shroud.0100
	title = "utopia.3000.name"
	desc = "gts_skadi_shroud.0100.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = {
		portrait = event_target:gts_skadi
		room = shroud_room
	}
	is_triggered_only = yes
	option = {
		name = "gts_skadi_shroud.0100.a"		#尝试跟这个存在交流
		hidden_effect = {
			country_event = {
				id = gts_skadi_shroud.0101
			}
		}
	}
}

country_event = {
	#签约
	id = gts_skadi_shroud.0101
	title = "utopia.3000.name"
	desc = "gts_skadi_shroud.0101.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = {
		portrait = skadi06
		room = shroud_room
	}
	is_triggered_only = yes
	option = {
		#这就是虚境，听伊莎玛拉说
		name = isharmla_answer01
		is_dialog_only = yes
		response_text = isharmla_answer01a
	}
	option = {
		name = isharmla_answer02
		is_dialog_only = yes
		response_text = isharmla_answer02a
	}
	option = {
		name = isharmla_answer03
		is_dialog_only = yes
		response_text = isharmla_answer03a
	}
	option = {
		name = isharmla_answer04
		is_dialog_only = yes
		response_text = isharmla_answer04a
	}
	option = {
		name = "gts_skadi_shroud.0101.a"
		custom_tooltip = "gts_skadi_shroud.0101.a.tooltip"		#别这么做
		add_modifier = {
			modifier = isharmla_awaken
			days = 9000
		}
		hidden_effect = {
			set_country_flag = has_shroud_patron
			set_country_flag = isharmla_comfirmed			#玛玛要把你抓走
			every_galaxy_planet = {
				limit = {
					NOR = {
						is_planet_class = pc_habitat
						is_planet_class = pc_ringworld_habitable
						is_planet_class = pc_shattered_ring_habitable
						is_planet_class = pc_cosmogenesis_world
						is_planet_class = pc_asteroid
						is_planet_class = pc_rare_crystal_asteroid
						is_planet_class = pc_ice_asteroid
						is_planet_class = pc_ringworld_habitable_damaged
						is_planet_class = pc_ringworld_seam
						is_planet_class = pc_ringworld_seam_damaged
						is_planet_class = pc_ringworld_tech
						is_planet_class = pc_ringworld_tech_damaged
						
						is_planet_class = pc_astral_scar
						is_planet_class = pc_b_star
						is_planet_class = pc_a_star
						is_planet_class = pc_f_star
						is_planet_class = pc_g_star
						is_planet_class = pc_k_star
						is_planet_class = pc_m_star
						is_planet_class = pc_m_giant_star
						is_planet_class = pc_t_star
						is_planet_class = pc_black_hole
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_toxoid_star
						is_planet_class = pc_rift_star
						is_planet_class = pc_gas_giant
						
						is_planet_class = pc_gts_juice
						is_planet_class = pc_gts_juice2
						is_planet_class = pc_gts_juice3
						is_planet_class = pc_gtsra_loli
						is_planet_class = pc_gtsra_loli_slave
						is_planet_class = pc_gts_kasa
						is_planet_class = pc_cheng_hui
						is_planet_class = pc_gts_oscillator
						is_planet_class = pc_gts_yarong
						is_planet_class = pc_gtsra_bronya_slave
						is_planet_class = pc_gts_luanzi
						
						has_modifier = skadi_shroud_marked
						has_modifier = skadi_satisfy_marked
					}
				}
				add_modifier = {
					modifier = skadi_shroud_marked
					days = -1
				}
			}
			every_subject = {
				#附庸球上标记
				every_owned_planet = {
					limit = {
						NOT = {
							has_modifier = skadi_shroud_marked
						}
					}
					add_modifier = {
						modifier = skadi_shroud_marked
						days = -1
					}
				}
			}
			every_country = {
				limit = {
					NOT = {
						is_ai = yes
					}
				}
				capital_scope = {
					remove_modifier = skadi_shroud_marked
					add_modifier = {
						modifier = skadi_satisfy_marked
						days = -1
					}
				}
			}
			set_variable = {
				#给一点满足点数
				which = isharmla_satisfy
				value = 0
			}
			set_variable = {
				#人口计数器
				which = eated_pop
				value = 0
			}
			country_event = {
				#签完事件
				id = gts_skadi_shroud.0102
			}
			country_event = {
				#负面
				id = gts_skadi_shroud.0007
				days = 500
			}
			country_event = {
				#第一次要饭
				id = gts_skadi_shroud.0201
				days = 1000
			}
			country_event = {
				#第二次要饭
				id = gts_skadi_shroud.0202
				days = 2000
			}
			country_event = {
				#灵能出逃
				id = gts_skadi_shroud.0204
				days = 3000
			}
			country_event = {
				#领袖变异
				id = gts_skadi_shroud.0301
				days = 4000
			}
			country_event = {
				#收养海嗣
				id = gts_skadi_shroud.0203
				days = 5000
			}
			country_event = {
				#解锁圣所
				id = gts_skadi_shroud.0207
				days = 6000
			}
			country_event = {
				#反抗
				id = gts_skadi_shroud.0205
				days = 7000
			}
			country_event = {
				#警告
				id = gts_skadi_shroud.0206
				days = 8000
			}
			country_event = {
				#判定结局
				id = gts_skadi_shroud.3318
				days = 9000
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}

planet_event = {
	#每个月判定一次上虚境标记
	id = gts_skadi_shroud.0001
	hide_window = yes
	pre_triggers = {
		has_owner = yes
	}
	mean_time_to_happen = {
		months = 1
	}
	trigger = {
		owner = {
			OR = {
				has_country_flag = isharmla_comfirmed
				AND = {
					is_subject = yes
					overlord = {
						has_country_flag = isharmla_comfirmed
					}
				}
			}
		}
		NOT = {
			has_modifier = skadi_satisfy_marked
			has_modifier = skadi_shroud_marked
			has_modifier = skadi_shroud_unmarked
			is_gts_reformed_planet = yes
			NOT = { has_planet_flag = gts_body_planet }
		}
	}
	immediate = {
		add_modifier = {
			modifier = skadi_shroud_marked
		}
	}
}

country_event = {
	#每个半年触发一次负面
	id = gts_skadi_shroud.0007
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		has_country_flag = isharmla_comfirmed
	}
	immediate = {
		isharmla_dislike_event = yes
		country_event = {
			id = gts_skadi_shroud.0007
			days = 360
		}
	}
}

country_event = {
	#全体领袖异变
	id = gts_skadi_shroud.0301
	title = gts_skadi_shroud.0301.title
	desc = gts_skadi_shroud.0301.desc
	is_triggered_only = yes
	picture = skadi_holyland
	show_sound = event_red_alert
	trigger = {
		owner = {
			has_country_flag = isharmla_comfirmed
		}
	}
	immediate = {

		# 10級有點多
		
		# 一次滿級就白白有那麼多事件給經驗了
		
		every_owned_leader = {
			add_skill_without_trait_selection = 5
		}

		every_owned_leader = {
			limit = {
				NOR = {
					has_leader_flag = gts_skadi
				}
				is_ruler = no
				is_heir = no
			}
			add_trait = {
				trait = skadi_leader_trait_horror
				show_message = no
			}
		}
		every_pool_leader = {
			add_skill_without_trait_selection = 10
			set_name = NAME_isharmla_seaheirs
			add_trait = {
					trait = skadi_leader_trait_variation
				}
			set_leader_flag = should_not_have_upkeep
		}
	}
	option = {
		name = gts_skadi_shroud.0301.a
	}
	option = {
		name = gts_skadi_shroud.0301.b
		custom_tooltip = gts_skadi_shroud.0301.b.tooltip
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_militarist
				has_ethic = ethic_militarist
			}
		}
		hidden_effect = {
			every_pool_leader = {
				limit = {
					has_trait = skadi_leader_trait_variation
				}
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0301.c
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
		add_monthly_resource_mult = {
			resource = unity
			value = @tier2unityreward
			min = @tier1unitymin
			max = @tier1unitymax
		}
		add_monthly_resource_mult = {
			resource = influence
			value = @tier2influencereward
			min = @tier2influencemin
			max = @tier2influencemax
		}
	}
	option = {
		name = gts_skadi_shroud.0301.d
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier3researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = @tier3researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
		add_monthly_resource_mult = {
			resource = engineering_research
			value = @tier3researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
	}
}

country_event = {
	#签完契约给事件
	id = gts_skadi_shroud.0102
	title = "gts_skadi_shroud.0102.name"
	desc = "gts_skadi_shroud.0102.desc"
	is_triggered_only = yes
	picture = GFX_evt_unspeakable_horror
	show_sound = event_mystic_reveal
	location = root
	immediate = {
		if = {
			limit = {
				NOT = {
					exists = event_target:shroud_country
				}
			}
			create_country = {
				name = "NAME_Creatures_of_the_Shroud"
				type = shroud_spirits
				flag = {
					icon = {
						category = "special"
						file = "the_shroud.dds"
					}
					background = {
						category = "backgrounds"
						file = "00_solid.dds"
					}
					colors = {
						"dark_purple"
						"black"
						"null"
					}
				}
			}
			last_created_country = {
				establish_communications_no_message = root
				set_country_flag = gts_bruh_skadi_event_shroud_country
				save_global_event_target_as = shroud_country
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0102.a
	}
	option = {
		name = gts_skadi_shroud.0102.b
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_militarist
				has_ethic = ethic_militarist
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0102.c
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0102.d
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
		}
	}
}

#一些能侍奉的事件
country_event = {
	#伊莎玛拉要饭事件
	id = gts_skadi_shroud.0201
	title = "utopia.3000.name"
	desc = "gts_skadi_shroud.0201.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = {
		portrait = skadi06
		room = shroud_room
	}
	is_triggered_only = yes
	trigger = {
		has_country_flag = isharmla_comfirmed
	}
	#给食物
	option = {
		name = gts_skadi_shroud.0201.a
		custom_tooltip = isharmla_like.tooltip
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0201.a.respond
		allow = {
			resource_stockpile_compare = {
				resource = food
				value >= 2500
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0201.a.complete
				}
			}
			add_resource = {
				food = -2500
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 1
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0201.a.complete
					days = 60
				}
			}
		}
	}
	#给大量食物
	option = {
		name = gts_skadi_shroud.0201.b
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0201.b.respond
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = food
				value >= 5000
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0201.b.complete
				}
			}
			add_resource = {
				food = -5000
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 2
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0201.b.complete
					days = 60
				}
			}
		}
	}
	#给矿物
	option = {
		name = gts_skadi_shroud.0201.c
		custom_tooltip = isharmla_like.tooltip
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0201.c.respond
		allow = {
			resource_stockpile_compare = {
				resource = minerals
				value >= 2500
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0201.c.complete
				}
			}
			add_resource = {
				minerals = -2500
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 1
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0201.c.complete
					days = 60
				}
			}
		}
	}
	#给大量矿物
	option = {
		name = gts_skadi_shroud.0201.d
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0201.d.respond
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = minerals
				value >= 5000
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0201.d.complete
				}
			}
			add_resource = {
				minerals = -5000
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 2
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0201.d.complete
					days = 60
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0201.e
		custom_tooltip = isharmla_dislike.tooltip
		default_hide_option = yes
		hidden_effect = {
			if = {
				limit = {
					NOR = {
						has_country_flag = gts_skadi_shroud.0201.a.complete
						has_country_flag = gts_skadi_shroud.0201.b.complete
						has_country_flag = gts_skadi_shroud.0201.c.complete
						has_country_flag = gts_skadi_shroud.0201.d.complete
					}
				}
				if = {
					limit = {
						check_variable = {
							which = isharmla_satisfy
							value > 0
						}
					}
					change_variable = {
						which = isharmla_satisfy
						value = -1
					}
				}
				isharmla_dislike_event = yes
			}
		}
	}
}

country_event = {
	#要饭给小人
	id = gts_skadi_shroud.0202
	title = "utopia.3000.name"
	desc = "gts_skadi_shroud.0202.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = {
		portrait = skadi06
		room = shroud_room
	}
	is_triggered_only = yes
	trigger = {
		has_country_flag = isharmla_comfirmed
	}
	#给小人
	option = {
		name = gts_skadi_shroud.0202.a
		custom_tooltip = isharmla_like.tooltip
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.a.respond
		trigger = {
			has_country_flag = gts_flag
		}
		allow = {
			resource_stockpile_compare = {
				resource = gts_micro
				value >= 1000
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.a.complete
				}
			}
			add_resource = {
				gts_micro = -1000
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 1
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.a.complete
					days = 60
				}
			}
		}
	}
	#给大量小人
	option = {
		name = gts_skadi_shroud.0202.b
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.b.respond
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = gts_micro
				value >= 2000
			}
		}
		trigger = {
			has_country_flag = gts_flag
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.b.complete
				}
			}
			add_resource = {
				gts_micro = -2000
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 2
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.b.complete
					days = 60
				}
			}
		}
	}
	#给城市
	option = {
		name = gts_skadi_shroud.0202.c
		custom_tooltip = isharmla_like.tooltip
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.c.respond
		allow = {
			resource_stockpile_compare = {
				resource = gts_micro_city
				value >= 500
			}
		}
		trigger = {
			has_country_flag = gts_flag
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.c.complete
				}
			}
			add_resource = {
				gts_micro_city = -500
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 1
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.c.complete
					days = 60
				}
			}
		}
	}
	#给大量城市
	option = {
		name = gts_skadi_shroud.0202.d
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.d.respond
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = gts_micro_city
				value >= 1000
			}
		}
		trigger = {
			has_country_flag = gts_flag
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.d.complete
				}
			}
			add_resource = {
				gts_micro_city = -1000
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 2
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.d.complete
					days = 60
				}
			}
		}
	}
	#小人文明触发
	option = {
		name = gts_skadi_shroud.0202.aa
		custom_tooltip = isharmla_like.tooltip
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.aa.respond
		trigger = {
			has_country_flag = tiny_flag
		}
		allow = {
			resource_stockpile_compare = {
				resource = gts_giantess_fluid
				value >= 1000
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.a.complete
				}
			}
			add_resource = {
				gts_giantess_fluid = -1000
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 1
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.a.complete
					days = 60
				}
			}
		}
	}
	#给大量小人
	option = {
		name = gts_skadi_shroud.0202.bb
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.bb.respond
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = gts_giantess_fluid
				value >= 2000
			}
		}
		trigger = {
			has_country_flag = tiny_flag
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.b.complete
				}
			}
			add_resource = {
				gts_giantess_fluid = -2000
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 2
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.b.complete
					days = 60
				}
			}
		}
	}
	#给城市
	option = {
		name = gts_skadi_shroud.0202.cc
		custom_tooltip = isharmla_like.tooltip
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.cc.respond
		allow = {
			resource_stockpile_compare = {
				resource = gts_giantess_human
				value >= 50
			}
		}
		trigger = {
			has_country_flag = tiny_flag
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.c.complete
				}
			}
			add_resource = {
				gts_giantess_human = -50
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 1
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.c.complete
					days = 60
				}
			}
		}
	}
	#给大量城市
	option = {
		name = gts_skadi_shroud.0202.dd
		is_dialog_only = yes
		response_text = gts_skadi_shroud.0202.dd.respond
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = gts_giantess_human
				value >= 100
			}
		}
		trigger = {
			has_country_flag = tiny_flag
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = gts_skadi_shroud.0202.d.complete
				}
			}
			add_resource = {
				gts_giantess_human = -100
			}
			hidden_effect = {
				change_variable = {
					which = isharmla_satisfy
					value = 2
				}
				set_timed_country_flag = {
					flag = gts_skadi_shroud.0202.d.complete
					days = 60
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0202.e
		custom_tooltip = isharmla_dislike.tooltip
		default_hide_option = yes
		hidden_effect = {
			if = {
				limit = {
					NOR = {
						has_country_flag = gts_skadi_shroud.0202.a.complete
						has_country_flag = gts_skadi_shroud.0202.b.complete
						has_country_flag = gts_skadi_shroud.0202.c.complete
						has_country_flag = gts_skadi_shroud.0202.d.complete
					}
				}
				if = {
					limit = {
						check_variable = {
							which = isharmla_satisfy
							value > 0
						}
					}
					change_variable = {
						which = isharmla_satisfy
						value = -1
					}
				}
				isharmla_dislike_event = yes
			}
		}
	}
}

country_event = {
	#收养海嗣
	id = gts_skadi_shroud.0203
	title = "utopia.3000.name"
	desc = "gts_skadi_shroud.0203.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = {
		portrait = skadi06
		room = shroud_room
	}
	is_triggered_only = yes
	trigger = {
		has_country_flag = isharmla_comfirmed
	}
	option = {
		name = gts_skadi_shroud.0203.a
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = unity
				value >= 3000
			}
		}
		add_resource = {
			unity = -3000
		}
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 2
			}
			capital_scope = {
				create_fleet = {
					name = "NAME_seaheirs"
					settings = {
						spawn_debris = no
						can_change_leader = no
						uses_naval_capacity = no
						can_disband = no
					}
					effect = {
						set_owner = root
						while = {
							count = 3
							create_ship = {
								name = "NAME_seaheirs"
								design = "NAME_seaheirs"
							}
						}
						set_location = prev
						set_fleet_stance = aggressive
						set_aggro_range_measure_from = return_point
						set_aggro_range = 3000
					}
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0203.b
		custom_tooltip = isharmla_like.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = unity
				value >= 1000
			}
		}
		add_resource = {
			unity = -1000
		}
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 1
			}
			capital_scope = {
				create_fleet = {
					name = "NAME_seaheirs"
					settings = {
						spawn_debris = no
						can_change_leader = no
						uses_naval_capacity = no
						can_disband = no
					}
					effect = {
						set_owner = root
						while = {
							count = 1
							create_ship = {
								name = "NAME_seaheirs"
								design = "NAME_seaheirs"
							}
						}
						set_location = prev
						set_fleet_stance = aggressive
						set_aggro_range_measure_from = return_point
						set_aggro_range = 3000
					}
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0203.c
		custom_tooltip = isharmla_dislike.tooltip
		default_hide_option = yes
		hidden_effect = {
			if = {
				limit = {
					check_variable = {
						which = isharmla_satisfy
						value > 0
					}
				}
				change_variable = {
					which = isharmla_satisfy
					value = -1
				}
			}
			isharmla_dislike_event = yes
		}
	}
}

country_event = {
	#有灵能存在逃出
	id = gts_skadi_shroud.0204
	title = "utopia.3000.name"
	desc = "gts_skadi_shroud.0204.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = {
		portrait = skadi06
		room = shroud_room
	}
	is_triggered_only = yes
	trigger = {
		has_country_flag = isharmla_comfirmed
	}
	immediate = {
		while = {
			count = 3
			random_system_within_border = {
				create_fleet = {
					name = "NAME_isharmla_food"
					settings = {
						spawn_debris = no
						is_boss = yes						#加骷髅头
					}
					effect = {
						set_owner = event_target:shroud_country
						create_ship = {
							name = "NAME_Shroud_Manifestation"
							design = "NAME_Shroud_Manifestation"
						}
						set_location = prev
						set_fleet_stance = aggressive
						set_aggro_range_measure_from = return_point
						set_aggro_range = 3000
					}
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0204.a
		custom_tooltip = isharmla_verylike.tooltip
		allow = {
			resource_stockpile_compare = {
				resource = food
				value >= 2500
			}
		}
		add_resource = {
			food = -2500
		}
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 2
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0204.b
		custom_tooltip = isharmla_like.tooltip
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 1
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0204.c
		custom_tooltip = isharmla_like.tooltip
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 1
			}
		}
		default_hide_option = yes
	}
}

country_event = {
	#反抗
	id = gts_skadi_shroud.0205
	title = "gts_skadi_shroud.0205_title"
	desc = "gts_skadi_shroud.0205_desc"
	picture = skadi_holyland
	show_sound = event_planetary_riot
	is_triggered_only = yes
	trigger = {
		has_country_flag = isharmla_comfirmed
	}
	option = {
		name = gts_skadi_shroud.0205.a
		custom_tooltip = isharmla_verylike.tooltip
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 2
			}
			change_variable = {
				which = eated_pop
				value = 20
			}
		}
		capital_scope = {
			add_planet_devastation = 50
			while = {
				count = 20
				random_owned_pop_group = {
					kill_single_pop = yes
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0205.b
		custom_tooltip = isharmla_like.tooltip
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 1
			}
		}
		capital_scope = {
			add_planet_devastation = 20
			while = {
				count = 10
				random_owned_pop_group = {
					kill_single_pop = yes
				}
			}
		}
		default_hide_option = yes
	}
	option = {
		name = gts_skadi_shroud.0205.c
		custom_tooltip = isharmla_verylike.tooltip
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 2
			}
		}
		event_target:gts_skadi = {
			kill_leader = {
				show_notification = yes
			}
		}
	}
}

country_event = {
	#警告
	id = gts_skadi_shroud.0206
	title = gts_skadi_shroud.0206.title
	desc = gts_skadi_shroud.0206.desc
	is_triggered_only = yes
	diplomatic = yes
	picture_event_data = {
		portrait = event_target:gts_skadi
		room = "ocean_room"
	}
	show_sound = event_mystic_reveal
	option = {
		name = skadi_warn01
		is_dialog_only = yes
		response_text = skadi_warn01a
	}
	option = {
		name = skadi_warn02
		is_dialog_only = yes
		response_text = skadi_warn02a
	}
	option = {
		name = skadi_warn03
		is_dialog_only = yes
		response_text = skadi_warn03a
	}
	option = {
		name = skadi_warn04
		clear_resources = yes
		hidden_effect = {
			change_variable = {
				which = isharmla_satisfy
				value = 5
			}
		}
	}
	option = {
		#结束对话
		name = skadi_warn05
		custom_tooltip = skadi_warn_tooltip
		default_hide_option = yes
	}
}

country_event = {
	#解锁圣所
	id = gts_skadi_shroud.0207
	title = "gts_skadi_shroud.0207_title"
	desc = "gts_skadi_shroud.0207_desc"
	picture = skadi_holyland
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = {
		has_country_flag = isharmla_comfirmed
	}
	immediate = {
		set_country_flag = isharmla_sanctum_building
	}
	option = {
		name = gts_skadi_shroud.0207.a
	}
	option = {
		name = gts_skadi_shroud.0207.b
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_militarist
				has_ethic = ethic_militarist
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0207.c
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0207.d
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
		}
	}
}

#惩罚事件

#吃20人口

country_event = {
	id = gts_skadi_shroud.0002
	title = gts_skadi_shroud.0002.title
	desc = gts_skadi_shroud.0002.desc
	is_triggered_only = yes
	picture = GFX_evt_unspeakable_horror
	show_sound = event_mystic_reveal
	location = event_target:victim_planet
	trigger = {
		any_owned_planet = {
			pop_amount > 2000
		}
	}
	immediate = {
		random_owned_planet = {
			limit = {
				pop_amount > 2000
			}
			save_event_target_as = victim_planet
			while = {
				count = 20
				random_owned_pop_group = {
					kill_single_pop = yes
				}
			}
		}
	}
	option = {
		name = gts_skadi_shroud.0002.a
		change_variable = {
			which = eated_pop
			value = 20
		}
	}
}

#领袖趋势
country_event = {
	id = gts_skadi_shroud.0003
	title = gts_skadi_shroud.0003.title
	desc = gts_skadi_shroud.0003.desc
	is_triggered_only = yes
	picture = skadi_oceanfall
	show_sound = event_mystic_reveal
	trigger = {
		any_owned_leader = {
			NOR = {
					has_trait = skadi_leader_train
					has_leader_flag = gts_skadi
					has_leader_flag = renowned_leader
					has_leader_flag = legendary_leader
				}
			is_heir = no
			is_ruler = no
		}
	}
	immediate = {
		#change_variable = {
		#	which = eated_pop
		#	value = 1
		#}
		random_owned_leader = {
			limit = {
				NOR = {
					has_trait = skadi_leader_train
					has_leader_flag = gts_skadi
					has_leader_flag = renowned_leader
					has_leader_flag = legendary_leader
				}
				is_ruler = no
				is_heir = no
			}
			save_event_target_as = victim_leader
		}
	}
	option = {
		name = gts_skadi_shroud.0003.a
		event_target:victim_leader = {
			kill_leader = {
				show_notification = no
			}
		}
	}
}

#整个殖民地寄掉
country_event = {
	id = gts_skadi_shroud.0004
	title = gts_skadi_shroud.0004.title
	desc = gts_skadi_shroud.0004.desc
	is_triggered_only = yes
	picture = skadi_oceanfall
	show_sound = event_mystic_reveal
	trigger = {
		any_owned_planet = {
			has_modifier = skadi_shroud_marked
		}
	}
	location = event_target:victim_planet
	immediate = {
		random_owned_planet = {
			limit = {
				has_modifier = skadi_shroud_marked
			}
			save_event_target_as = victim_planet
		}
		event_target:victim_planet = {
			
			# 計算人口數量
			
			export_trigger_value_to_variable = {
				trigger = pop_amount
				variable = gts_bruh_get_planet_killed_pop_count
			}
			divide_variable = {
				which = gts_bruh_get_planet_killed_pop_count
				value = 100
			}
			round_variable = gts_bruh_get_planet_killed_pop_count

			destroy_colony = yes
			remove_modifier = skadi_shroud_marked
		}
	}
	option = {
		name = gts_skadi_shroud.0004.a
		hidden_effect = {
			root = {
				change_variable = {
					which = eated_pop
					value = event_target:victim_planet.gts_bruh_get_planet_killed_pop_count
				}
			}
		}
	}
}

#随机星系生成海嗣
country_event = {
	id = gts_skadi_shroud.0005
	title = gts_skadi_shroud.0005.title
	desc = gts_skadi_shroud.0005.desc
	is_triggered_only = yes
	picture = skadi_seaheirs
	show_sound = event_mystic_reveal
	location = event_target:gts_bruh_get_event_location
	immediate = {
		random_country = {
			limit = {
				has_country_flag = gts_bruh_skadi_event_shroud_country
			}
			save_event_target_as = gts_bruh_skadi_event_fleet_owner
		}
		random_system_within_border = {
			create_fleet = {
				name = "NAME_lostseaheirs"
				settings = {
					spawn_debris = no
					ai_ignore_strength = yes
					is_boss = yes					#加骷髅头
				}
				effect = {
					save_global_event_target_as = seaheirs
					set_owner = event_target:gts_bruh_skadi_event_fleet_owner
					create_ship = {
						name = "NAME_lostseaheirs"
						design = "NAME_seaheirs"
					}
					set_location = prev
					set_fleet_stance = evasive
					set_aggro_range_measure_from = return_point
					set_aggro_range = 10000
					fleet_event = {
						id = gts_skadi_shroud.0008
					}
				}
			}
			save_event_target_as = gts_bruh_get_event_location
		}
	}
	option = {
		name = gts_skadi_shroud.0005.a
	}
}
#海嗣的行为
fleet_event = {
	id = gts_skadi_shroud.0008
	hide_window = yes

	trigger = {
		NOT = { has_global_flag = seaheirs_orders_cooldown }
		owner = { is_country_type = shroud_spirits }
		exists = event_target:seaheirs
		event_target:seaheirs= { is_same_value = root }
		any_system = {
			any_system_planet = {
				OR = {
					is_colonizable = yes
					has_owner = yes
					owner = {
						is_country_type = default
					}
				}
			}
		}
	}

	is_triggered_only = yes

	immediate = {
		set_timed_global_flag = { flag = seaheirs_orders_cooldown days = 1 }
		closest_system = {
			limit = {
				any_system_planet = {
					OR = {
						is_colonizable = yes
						has_owner = yes
					}
				}
			}
			random_system_planet = {
				limit = {
					OR = {
						is_colonizable = yes
						has_owner = yes
					}
					OR = {
						owner = {
							is_country_type = default
						}
					}
				}
				save_event_target_as = move_to_planet
			}
		}
		queue_actions = {
			find_closest_system = {
				trigger = {
					id = gts_skadi_shroud.0008.t1
					any_system_planet = {
						is_same_value = event_target:move_to_planet
					}
				}
				found_system = {
					move_to = this
					find_closest_planet = {
						trigger = {
							id = gts_skadi_shroud.0008.t2
							is_same_value = event_target:move_to_planet
						}
						found_planet = {
							move_to = this
							effect = {
								id = gts_skadi_shroud.0008.e1
								set_timed_global_flag = { flag = seaheirs_orders_cooldown days = 1 }
								planet_event = { id = gts_skadi_shroud.0009 }
								prevprev = {
									destroy_fleet = this
								}
							}
						}
					}
				}
			}
		}
		fleet_event = {
			id = gts_skadi_shroud.0008
			days = 30
		}
	}
}

planet_event = {
	id = gts_skadi_shroud.0009
	title = "utopia.3324.name"
	desc = "utopia.3324.desc"
	picture = GFX_evt_unspeakable_horror
	show_sound = event_red_alert
	location = root

	is_triggered_only = yes

	immediate = {
		destroy_colony = yes
	}

	option = {
		name = "utopia.3324.opt.a"
	}
}
#给一个诅咒
country_event = {
	id = gts_skadi_shroud.0006
	title = gts_skadi_shroud.0006.title
	desc = gts_skadi_shroud.0006.desc
	is_triggered_only = yes
	picture = skadi_holyland
	show_sound = event_mystic_reveal
	immediate = {
		add_modifier = {
			modifier = isharmla_tease
			days = 720
		}
	}
	option = {
		name = gts_skadi_shroud.0006.a
	}
}

#二十五年的判定
country_event = {
	id = gts_skadi_shroud.3318
	title = "gts_skadi_shroud.3319.name"
	desc = "gts_skadi_shroud.3318.desc"
	picture = skadi_shrunk
	show_sound = event_red_alert
	location = root
	is_triggered_only = yes
	option = {
		name = gts_skadi_shroud.3318.a
		country_event = {
			id = gts_skadi_shroud.3319
		}
	}
}

country_event = {
	id = gts_skadi_shroud.3319
	title = "gts_skadi_shroud.3319.name"
	desc = "gts_skadi_shroud.3319.desc"
	picture = skadi_shrunk2
	location = root
	is_triggered_only = yes
	option = {
		name = gts_skadi_shroud.3319.a
		if = {
			limit = {
				OR = {
					check_variable = {
						which = isharmla_satisfy
						value < 5
					}
					NOR = {
						exists = event_target:gts_skadi
					}
				}
			}
			country_event = {
				id = gts_skadi_shroud.3320
			}
		}
		else = {
			country_event = {
				id = gts_skadi_shroud.3321
			}
		}
	}
}

#大啖食粮之时已经到来
country_event = {
	id = gts_skadi_shroud.3320
	title = "gts_skadi_shroud.3320.name"
	desc = "gts_skadi_shroud.3320.desc"
	picture = GFX_evt_unspeakable_horror
	show_sound = event_red_alert
	location = root
	is_triggered_only = yes
	immediate = {
		clear_resources = yes
		add_resource = {
			energy = 1000
			minerals = 1000
			food = 1000
			alloys = 1000
			consumer_goods = 1000
		}
		if = {
			limit = {
				NOT = {
					exists = event_target:shroud_country
				}
			}
			create_country = {
				name = "NAME_Creatures_of_the_Shroud"
				type = shroud_spirits
				flag = {
					icon = {
						category = "special"
						file = "the_shroud.dds"
					}
					background = {
						category = "backgrounds"
						file = "00_solid.dds"
					}
					colors = {
						"dark_purple"
						"black"
						"null"
					}
				}
			}
			last_created_country = {
				establish_communications_no_message = root
				save_global_event_target_as = shroud_country
			}
		}
		kill_leader = {
			show_notification = no
			heir = yes
		}
		kill_leader = {
			show_notification = no
			ruler = yes
		}
		#没受训的全嘎
		every_owned_leader = {
			limit = {
				NOR = {
					has_leader_flag = skadi_Titantrained
					has_leader_flag = skadi_trained
					has_leader_flag = gts_skadi
				}
			}
			kill_leader = {
				show_notification = no
			}
		}
		every_country = {
			every_controlled_fleet = {
				destroy_fleet = this
			}
		}
		#每颗星球寄
		every_galaxy_planet = {
			limit = {
				has_modifier = skadi_shroud_unmarked
			}
			remove_modifier = skadi_shroud_unmarked
		}

		# 應該不會需要這個
		
		# 但還是放著備用
		
		every_galaxy_planet = {
			limit = {
				NOT = { is_owned_by = root }
				has_modifier = skadi_satisfy_marked
			}
			remove_modifier = skadi_satisfy_marked
		}
		
		# eated_pop計算
		
		# 每100人 = 1個eated_pop
		
		every_galaxy_planet = {
			
			# 除了首都外有人的星球
			
			limit = {
				is_colony = yes
				is_capital = no
			}
			
			# 計算人口數量
			
			export_trigger_value_to_variable = {
				trigger = pop_amount
				variable = gts_bruh_get_planet_killed_pop_count
			}
			divide_variable = {
				which = gts_bruh_get_planet_killed_pop_count
				value = 100
			}
			round_variable = gts_bruh_get_planet_killed_pop_count
			
			root = {
				change_variable = {
					which = eated_pop
					value = gts_bruh_get_planet_killed_pop_count
				}
			}
		}
		#每颗星球寄
		every_galaxy_planet = {
			limit = {
				has_modifier = skadi_shroud_marked
			}
			remove_modifier = skadi_shroud_marked
			remove_all_armies = yes
			
			#星球变成爱液
            if = {
				limit = {
					is_planet_class = pc_habitat
				}
				destroy_colony = yes
				
				# 把居住站刪了
				
				remove_planet = yes
				
			}
            else_if = {
				limit = {
					is_ringworld = yes
				}
				gts_bruh_clear_planet_effect = yes
				change_pc = pc_ringworld_habitable_damaged
			}
			else_if = {
				limit = {
					NOT = {
						has_modifier = skadi_satisfy_marked
					}
					is_capital = yes
				}
				gts_bruh_clear_planet_effect = yes
				pc_gts_juice_change = yes
			}
		}
		#给所有国家降好感
		every_country = {
			limit = {
				NOT = {
					is_same_value = root
				}
				is_country_type = default
			}
			add_opinion_modifier = {
				modifier = opinion_skadi_brought
				who = root
			}
		}
		remove_country_flag = isharmla_comfirmed
		set_country_flag = isharmla_finished
	}
	option = {
		name = gts_skadi_shroud.3320.a
		hidden_effect = {
		
			# 整個銀河變成愛液
			
			# 除了恆星、黑洞之類的
			
			# 這要複製四份
			
			every_galaxy_planet = {
				limit = {
					NOR = {
						is_planet_class = pc_habitat
						is_planet_class = pc_ringworld_habitable
						is_planet_class = pc_shattered_ring_habitable
						is_planet_class = pc_cosmogenesis_world
						is_planet_class = pc_asteroid
						is_planet_class = pc_rare_crystal_asteroid
						is_planet_class = pc_ice_asteroid
						is_planet_class = pc_ringworld_habitable_damaged
						is_planet_class = pc_ringworld_seam
						is_planet_class = pc_ringworld_seam_damaged
						is_planet_class = pc_ringworld_tech
						is_planet_class = pc_ringworld_tech_damaged
						
						is_planet_class = pc_astral_scar
						is_planet_class = pc_b_star
						is_planet_class = pc_a_star
						is_planet_class = pc_f_star
						is_planet_class = pc_g_star
						is_planet_class = pc_k_star
						is_planet_class = pc_m_star
						is_planet_class = pc_m_giant_star
						is_planet_class = pc_t_star
						is_planet_class = pc_black_hole
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_toxoid_star
						is_planet_class = pc_rift_star
						is_planet_class = pc_gas_giant
						
						is_planet_class = pc_gts_juice
						is_planet_class = pc_gts_juice2
						is_planet_class = pc_gts_juice3
						is_planet_class = pc_gtsra_loli
						is_planet_class = pc_gtsra_loli_slave
						is_planet_class = pc_gts_kasa
						is_planet_class = pc_cheng_hui
						is_planet_class = pc_gts_oscillator
						is_planet_class = pc_gts_yarong
						is_planet_class = pc_gtsra_bronya_slave
						is_planet_class = pc_gts_luanzi
						
						is_capital = yes
						
						has_modifier = skadi_satisfy_marked
					}
				}
				gts_bruh_clear_planet_effect = yes
				destroy_colony = yes
				change_pc = pc_gts_juice_uncolonizable
				add_deposit = d_gts_giantess_fluid_3
			}
		}
	}
	option = {
		name = gts_skadi_shroud.3320.b
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_militarist
				has_ethic = ethic_militarist
			}
		}
		hidden_effect = {
		
			# 整個銀河變成愛液
			
			# 除了恆星、黑洞之類的
			
			# 這要複製四份
			
			every_galaxy_planet = {
				limit = {
					NOR = {
						is_planet_class = pc_habitat
						is_planet_class = pc_ringworld_habitable
						is_planet_class = pc_shattered_ring_habitable
						is_planet_class = pc_cosmogenesis_world
						is_planet_class = pc_asteroid
						is_planet_class = pc_rare_crystal_asteroid
						is_planet_class = pc_ice_asteroid
						is_planet_class = pc_ringworld_habitable_damaged
						is_planet_class = pc_ringworld_seam
						is_planet_class = pc_ringworld_seam_damaged
						is_planet_class = pc_ringworld_tech
						is_planet_class = pc_ringworld_tech_damaged
						
						is_planet_class = pc_astral_scar
						is_planet_class = pc_b_star
						is_planet_class = pc_a_star
						is_planet_class = pc_f_star
						is_planet_class = pc_g_star
						is_planet_class = pc_k_star
						is_planet_class = pc_m_star
						is_planet_class = pc_m_giant_star
						is_planet_class = pc_t_star
						is_planet_class = pc_black_hole
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_toxoid_star
						is_planet_class = pc_rift_star
						is_planet_class = pc_gas_giant
						
						is_planet_class = pc_gts_juice
						is_planet_class = pc_gts_juice2
						is_planet_class = pc_gts_juice3
						is_planet_class = pc_gtsra_loli
						is_planet_class = pc_gtsra_loli_slave
						is_planet_class = pc_gts_kasa
						is_planet_class = pc_cheng_hui
						is_planet_class = pc_gts_oscillator
						is_planet_class = pc_gts_yarong
						is_planet_class = pc_gtsra_bronya_slave
						is_planet_class = pc_gts_luanzi
						
						is_capital = yes
						
						has_modifier = skadi_satisfy_marked
					}
				}
				gts_bruh_clear_planet_effect = yes
				destroy_colony = yes
				change_pc = pc_gts_juice_uncolonizable
				add_deposit = d_gts_giantess_fluid_3
			}
		}
	}
	option = {
		name = gts_skadi_shroud.3320.c
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
		hidden_effect = {
		
			# 整個銀河變成愛液
			
			# 除了恆星、黑洞之類的
			
			# 這要複製四份
			
			every_galaxy_planet = {
				limit = {
					NOR = {
						is_planet_class = pc_habitat
						is_planet_class = pc_ringworld_habitable
						is_planet_class = pc_shattered_ring_habitable
						is_planet_class = pc_cosmogenesis_world
						is_planet_class = pc_asteroid
						is_planet_class = pc_rare_crystal_asteroid
						is_planet_class = pc_ice_asteroid
						is_planet_class = pc_ringworld_habitable_damaged
						is_planet_class = pc_ringworld_seam
						is_planet_class = pc_ringworld_seam_damaged
						is_planet_class = pc_ringworld_tech
						is_planet_class = pc_ringworld_tech_damaged
						
						is_planet_class = pc_astral_scar
						is_planet_class = pc_b_star
						is_planet_class = pc_a_star
						is_planet_class = pc_f_star
						is_planet_class = pc_g_star
						is_planet_class = pc_k_star
						is_planet_class = pc_m_star
						is_planet_class = pc_m_giant_star
						is_planet_class = pc_t_star
						is_planet_class = pc_black_hole
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_toxoid_star
						is_planet_class = pc_rift_star
						is_planet_class = pc_gas_giant
						
						is_planet_class = pc_gts_juice
						is_planet_class = pc_gts_juice2
						is_planet_class = pc_gts_juice3
						is_planet_class = pc_gtsra_loli
						is_planet_class = pc_gtsra_loli_slave
						is_planet_class = pc_gts_kasa
						is_planet_class = pc_cheng_hui
						is_planet_class = pc_gts_oscillator
						is_planet_class = pc_gts_yarong
						is_planet_class = pc_gtsra_bronya_slave
						is_planet_class = pc_gts_luanzi
						
						is_capital = yes
						
						has_modifier = skadi_satisfy_marked
					}
				}
				gts_bruh_clear_planet_effect = yes
				destroy_colony = yes
				change_pc = pc_gts_juice_uncolonizable
				add_deposit = d_gts_giantess_fluid_3
			}
		}
	}
	option = {
		name = gts_skadi_shroud.3320.d
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
		}
		hidden_effect = {
		
			# 整個銀河變成愛液
			
			# 除了恆星、黑洞之類的
			
			# 這要複製四份
			
			every_galaxy_planet = {
				limit = {
					NOR = {
						is_planet_class = pc_habitat
						is_planet_class = pc_ringworld_habitable
						is_planet_class = pc_shattered_ring_habitable
						is_planet_class = pc_cosmogenesis_world
						is_planet_class = pc_asteroid
						is_planet_class = pc_rare_crystal_asteroid
						is_planet_class = pc_ice_asteroid
						is_planet_class = pc_ringworld_habitable_damaged
						is_planet_class = pc_ringworld_seam
						is_planet_class = pc_ringworld_seam_damaged
						is_planet_class = pc_ringworld_tech
						is_planet_class = pc_ringworld_tech_damaged
						
						is_planet_class = pc_astral_scar
						is_planet_class = pc_b_star
						is_planet_class = pc_a_star
						is_planet_class = pc_f_star
						is_planet_class = pc_g_star
						is_planet_class = pc_k_star
						is_planet_class = pc_m_star
						is_planet_class = pc_m_giant_star
						is_planet_class = pc_t_star
						is_planet_class = pc_black_hole
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_toxoid_star
						is_planet_class = pc_rift_star
						is_planet_class = pc_gas_giant
						
						is_planet_class = pc_gts_juice
						is_planet_class = pc_gts_juice2
						is_planet_class = pc_gts_juice3
						is_planet_class = pc_gtsra_loli
						is_planet_class = pc_gtsra_loli_slave
						is_planet_class = pc_gts_kasa
						is_planet_class = pc_cheng_hui
						is_planet_class = pc_gts_oscillator
						is_planet_class = pc_gts_yarong
						is_planet_class = pc_gtsra_bronya_slave
						is_planet_class = pc_gts_luanzi
						
						is_capital = yes
						
						has_modifier = skadi_satisfy_marked
					}
				}
				gts_bruh_clear_planet_effect = yes
				destroy_colony = yes
				change_pc = pc_gts_juice_uncolonizable
				add_deposit = d_gts_giantess_fluid_3
			}
		}
	}
}

#活下来
country_event = {
	id = gts_skadi_shroud.3321
	title = "gts_skadi_shroud.3321.name"
	desc = "gts_skadi_shroud.3321.desc"
	picture = GFX_evt_vortex
	show_sound = event_celebration
	location = root
	is_triggered_only = yes
	immediate = {
		event_target:gts_skadi = {
			add_trait = {
				trait = skadi_leader_trait_corrupting
			}
			change_leader_portrait = skadi05
		}
		#消掉惊恐debuff
		every_owned_leader = {
			limit = {
				has_trait = skadi_leader_trait_horror
			}
			remove_trait = skadi_leader_trait_horror
		}
		#把附庸国的debuff消掉
		every_galaxy_planet = {
			limit = {
				has_modifier = skadi_shroud_marked
				exists = owner
				owner = {
					AND = {
						is_subject = yes
						overlord = {
							has_country_flag = isharmla_comfirmed
						}
					}
				}
			}
			remove_modifier = skadi_shroud_marked
		}
		every_galaxy_planet = {
			limit = {
				has_modifier = skadi_shroud_unmarked
			}
			remove_modifier = skadi_shroud_unmarked
		}
		#每颗星球寄
		every_galaxy_planet = {
			limit = {
				NOT = { is_owned_by = root }
				has_modifier = skadi_satisfy_marked
			}
			remove_modifier = skadi_satisfy_marked
		}
		
		# eated_pop計算
		
		# 每100人 = 1個eated_pop
		
		every_galaxy_planet = {
			
			# 除了首都外有人的星球
			
			limit = {
				is_colony = yes
				is_capital = no
				has_modifier = skadi_shroud_marked
			}
			
			# 計算人口數量
			
			export_trigger_value_to_variable = {
				trigger = pop_amount
				variable = gts_bruh_get_planet_killed_pop_count
			}
			divide_variable = {
				which = gts_bruh_get_planet_killed_pop_count
				value = 100
			}
			round_variable = gts_bruh_get_planet_killed_pop_count
			
			root = {
				change_variable = {
					which = eated_pop
					value = gts_bruh_get_planet_killed_pop_count
				}
			}
		}
		#每颗星球寄
		every_galaxy_planet = {
			limit = {
				has_modifier = skadi_shroud_marked
			}
			remove_modifier = skadi_shroud_marked
			remove_all_armies = yes
			#星球变成爱液
			if = {
				limit = {
					is_planet_class = pc_habitat
				}
				destroy_colony = yes
				remove_planet = yes
			}
			else_if = {
				limit = {
					is_ringworld = yes
				}
				gts_bruh_clear_planet_effect = yes
				change_pc = pc_ringworld_habitable_damaged
			}
			else_if = {
				limit = {
					is_owned_by = root
					NOR = {
						is_planet_class = pc_gts_juice
						is_planet_class = pc_gts_juice2
						is_planet_class = pc_gts_juice3
						is_planet_class = pc_gtsra_loli
						is_planet_class = pc_gtsra_loli_slave
						is_planet_class = pc_gts_kasa
						is_planet_class = pc_cheng_hui
						is_planet_class = pc_gts_oscillator
						is_planet_class = pc_gts_yarong
						is_planet_class = pc_gtsra_bronya_slave
						is_planet_class = pc_gts_luanzi
					}
				}
				gts_bruh_clear_planet_effect = yes
				destroy_colony = yes
				
				hidden_effect = {
					pc_gts_juice_change = yes
					
					# 移除地形
					
					while = {
						count = 3
						remove_deposit = d_juice_ruin1
						remove_deposit = d_juice_ruin2
						remove_deposit = d_juice_ruin3
						remove_deposit = d_juice_ruin5
						add_deposit = d_juice_ruin6
					}
				}
			}
		}
		#给所有国家加好感
		every_country = {
			limit = {
				NOT = {
					is_same_value = root
				}
				is_country_type = default
			}
			add_opinion_modifier = {
				modifier = opinion_skadi_overcome
				who = root
			}
		}
		country_event = {
			id = gts_skadi_shroud.3324
			days = 7
		}
		remove_country_flag = isharmla_comfirmed
		set_country_flag = skadi_comfirmed
	}
	option = {
		name = gts_skadi_shroud.3321.a
	}
	option = {
		name = gts_skadi_shroud.3321.b
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_militarist
				has_ethic = ethic_militarist
			}
		}
	}
	option = {
		name = gts_skadi_shroud.3321.c
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
	}
	option = {
		name = gts_skadi_shroud.3321.d
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
		}
	}
}

#人口和领袖得灵能
country_event = {
	id = gts_skadi_shroud.3322
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		exists = event_target:gts_skadi
		event_target:gts_skadi = {
			has_trait = skadi_leader_trait_corrupting
			is_ruler = yes
		}
	}
	immediate = {
		random_owned_leader = {
			limit = {
				NOR = {
					has_trait = leader_trait_psionic
					has_trait = leader_trait_chosen
					has_trait = skadi_leader_trait_corrupting
				}
			}
			add_trait = {
				trait = leader_trait_psionic
			}
			if = { #天体级弹的消息
				limit = {
					has_trait = leader_trait_Ultra
				}
				random_list = {
					1 = {						
						create_skadi_give_massage = {
							localization = skadi_give_psionic1
						}
					}
					1 = {
						create_skadi_give_massage = {
							localization = skadi_give_psionic2
						}
					}
				}
			}
			else = {
				random_list = {
					1 = {
						create_skadi_give_massage = {
							localization = skadi_give_psionic3
						}
					}
					1 = {
						create_skadi_give_massage = {
							localization = skadi_give_psionic4
						}
					}
					1 = {
						create_skadi_give_massage = {
							localization = skadi_give_psionic5
						}
					}
					1 = {
						create_skadi_give_massage = {
							localization = skadi_give_psionic6
						}
					}
					1 = {
						create_skadi_give_massage = {
							localization = skadi_give_psionic7
						}
					}
					1 = {
						create_skadi_give_massage = {
							localization = skadi_give_psionic8
						}
					}
				}
			}
		}
		while = {
			count = 20
			random_owned_pop_group = {
				limit = {
					NOR = {
						has_trait = trait_psionic
					}
				}
				modify_species = {
					add_trait = trait_psionic
				}
			}
		}
	}
}

#蒂蒂登基
country_event = {

	id = gts_skadi_shroud.3324
	title = "gts_skadi_shroud.3324.tile"
	desc = "gts_skadi_shroud.3324.desc"

	show_sound = event_celebration
	event_window_type = leader_recruit
	notification_event_icon = "message_leader_recruitment_skadi"
	picture = GFX_leader_recruitment_bg_legendary_skrand

	auto_opens = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:gts_skadi
		room = "galactic_emperor_room"
	}

	option = {
		name = gts_skadi_shroud.3324.a
		response_text = gts_skadi_shroud.3324.a.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_shroud.3324.b
		response_text = gts_skadi_shroud.3324.b.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_shroud.3324.c
		response_text = gts_skadi_shroud.3324.c.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_shroud.3324.d
		response_text = gts_skadi_shroud.3324.d.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_shroud.3324.e
		response_text = gts_skadi_shroud.3324.e.response
		is_dialog_only = yes
	}
	option = {
		name = gts_skadi_shroud.3324.f
		tag = hire_leader
	}
	option = {
		name = gts_skadi_shroud.3324.h
		tag = dismiss_leader
		set_leader = event_target:gts_skadi
		#给一个国民理念
		force_add_civic = civic_psionic_sovereign
		hidden_effect = {
			country_event = {
				id = gts_skadi_shroud.3322
			}
		}
	}
}

