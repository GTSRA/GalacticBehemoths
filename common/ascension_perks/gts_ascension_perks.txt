ap_space_gts = {
	potential = {
		NOT = {
			has_ascension_perk = ap_space_gts
		}
	}
	modifier = {
		command_limit_add = 20
	}
	on_enabled = {
		custom_tooltip = "add_research_options_space_gts"
		hidden_effect = {
			country_event = {
				id = gts_ap_shipgirl.1
			}
			country_event = {
            	id = gts_saratoga.1
            	days = 1
            }
		}
	}
	possible = {
		has_ascension_perk = ap_master_builders
	}
	ai_weight = {
		#对于 AI 的点击的权重判定 
		factor = 0
	}
}
ap_gts_planet = {
	potential = {
		NOT = {
			has_ascension_perk = ap_gts_planet
		}
	}
	modifier = {
		
	}
	on_enabled = {
		custom_tooltip = "add_research_options_gts_planet"
		add_tradition = tradition_gts_toy_planets_adopt
		# add_research_option = tech_gts_juice_colonies
		# add_research_option = tech_gts_bfbf_habitability
	}
	possible = {
		custom_tooltip = {
			fail_text = "requires_ascension_perks_1"
			num_ascension_perks >= 1
		 }
	}
	ai_weight = {
		factor = 0
	}
}
# ap_gts_colossus = {
# 	#ID,你的飞升在程序里面的名称
# 	potential = {
# 		#限制语句，没有符合此条件，则无法显示
# 		NOT = {
# 			has_ascension_perk = ap_gts_colossus			#一般对于一个飞升而言，我们都希望不要在点击之后还能看见它
# 		}
# 	}
# 	on_enabled = {
# 		#指在启动时触发的语句，可以是效果 effect 也可以是事件 event
# 		if = {
# 			limit = {
# 				NOT = {
# 					has_technology = tech_pk_gts_shrink
# 				}
# 			}
# 			add_research_option = tech_pk_gts_shrink
# 		}
# 	}
# 	possible = {
# 		#允许的判断，比 potential 的优先级要低。当不满足时显示为黑白图
# 		custom_tooltip = {
# 			fail_text = "requires_colossus_gts"
# 			has_technology = tech_colossus
# 		}
# 	}
# 	ai_weight = {
# 		#对于 AI 的点击的权重判定
# 		factor = 0
# 	}
# }

#把原版的天灾加进来改了一下判定，要求不能有除神之路这个飞升
ap_gts_115tiny_crisis = {
	potential = {
		NOR = {
			has_ascension_perk = ap_become_the_crisis
			has_ascension_perk = ap_gts_115tiny_crisis
			has_ascension_perk = ap_behemoths
			has_ascension_perk = ap_cosmogenesis
			has_country_flag = gts_flag
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_ascension_perks_1"
			num_ascension_perks > 0
		}
		custom_tooltip = {
			fail_text = "requires_not_origin_annihilator"
			NOT = { has_origin = origin_annihilator }
		}
		custom_tooltip = {
			fail_text = "requires_not_origin_god_keeper"
			if = {
				limit = {
					not = {
						and = {
							has_origin = origin_god_keeper
							not = {
								any_owned_leader = {
									or = {
										has_trait = god_keeper_ruler_trait2
										has_trait = god_keeper_ruler_trait1
									}
								}
							}
						}
					}
				}
			}
			else_if = {
				limit = {
					has_origin = origin_god_keeper
					any_owned_leader = {
						or = {
							has_trait = god_keeper_ruler_trait2
							has_trait = god_keeper_ruler_trait1
						}
					}
				}
			}
			else = {
				not = {
					has_origin = origin_god_keeper
				}
			}
		}
	}

	on_enabled = {
		hidden_effect = {
			set_ai_personality = became_the_crisis
			set_variable = {
				which = godness_power_world_focus_produced
				value = 0
			}

		}
		activate_crisis_progression = gts_115tiny_crisis_path
	}

	ai_weight = {
		factor = 7.5
		modifier = {
			factor = 0
		}
		modifier = {
			factor = 10
			is_homicidal = yes
		}
		modifier = {
			factor = 2
			has_tradition = tr_supremacy_finish
		}
		modifier = {
			factor = 0
			galaxy_percentage < 0.1
		}
		modifier = {
			factor = 2
			galaxy_percentage > 0.2
		}
		modifier = {
			factor = 0
			count_playable_country = {
				count > 1
				limit = {
					has_ascension_perk = ap_gts_115tiny_crisis
				}
			}
		}
		modifier = {
			factor = 0
			blocks_disruptive_gameplay = yes
		}
	}
}

#################
# Cybernetics ASCENSION PERKS
#################

ap_cosmogenesis = {
	potential = {
		has_machine_age_dlc = yes
		NOR = {
			has_ascension_perk = ap_become_the_crisis
			has_ascension_perk = ap_cosmogenesis
			has_ascension_perk = ap_gts_115tiny_crisis
			has_ascension_perk = ap_defender_of_the_galaxy
			has_origin = origin_slavers # No crisis for MSI
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_ascension_perks_3"
			num_ascension_perks > 2
		}
		custom_tooltip = {
			fail_text = "requires_independence"
			is_subject = no
		}
		custom_tooltip = {
			fail_text = "must_not_be_custodian"
			is_galactic_custodian = no
		}
		custom_tooltip = {
			fail_text = "must_not_be_emperor"
			is_galactic_emperor = no
		}
	}

	on_enabled = {
		hidden_effect = {
			set_variable = {
				which = cosmogenesis_world_advanced_logic_produced
				value = 0
			}
		}
		activate_crisis_progression = cosmogenesis_path
	}

	ai_weight = {
		factor = 7.5
		modifier = {
			factor = 0
			OR = {
				is_egalitarian = yes
				is_xenophile = yes
			}
		}
		modifier = {
			factor = 2
			has_tradition = tr_discovery_finish
		}
		modifier = {
			factor = 2
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = {
			factor = 2
			has_ascension_perk = ap_enigmatic_engineering
		}
		modifier = {
			factor = 2
			vassals > 0
			any_subject = {
				any_agreement = {
					has_active_specialization = specialist_scholarium
				}
			}
		}
		modifier = {
			factor = 10
			has_country_flag = whisperers_covenant_confirmed
		}
		modifier = {
			factor = 0
			galaxy_percentage < 0.1
		}
		modifier = {
			factor = 2
			galaxy_percentage > 0.2
		}
	}
}

#################
# NEMESIS ASCENSION PERKS
#################

ap_become_the_crisis = {
	potential = {
		has_nemesis = yes
		NOR = {
			has_ascension_perk = ap_become_the_crisis
			has_ascension_perk = ap_gts_115tiny_crisis
			has_ascension_perk = ap_cosmogenesis
			has_ascension_perk = ap_defender_of_the_galaxy
			has_origin = origin_slavers
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_ascension_perks_3"
			num_ascension_perks > 2
		}
		custom_tooltip = {
			fail_text = "requires_independence"
			is_subject = no
		}
		custom_tooltip = {
			fail_text = "must_not_be_custodian"
			is_galactic_custodian = no
		}
		custom_tooltip = {
			fail_text = "must_not_be_emperor"
			is_galactic_emperor = no
		}
		NOR = {
			has_ethic = ethic_xenophile
			has_ethic = ethic_fanatic_xenophile
			has_ethic = ethic_pacifist
			has_ethic = ethic_fanatic_pacifist
			has_civic = civic_machine_servitor
		}
	}

	on_enabled = {
		hidden_effect = {
			set_ai_personality = became_the_crisis
		}
		activate_crisis_progression = nemesis_path
	}

	ai_weight = {
		factor = 7.5
		modifier = {
			factor = 0
			NOR = {
				is_militarist = yes
				is_xenophobe = yes
				is_gestalt = yes
			}
		}
		modifier = {
			factor = 10
			is_homicidal = yes
		}
		modifier = {
			factor = 2
			has_tradition = tr_supremacy_finish
		}
		modifier = {
			factor = 0
			galaxy_percentage < 0.1
		}
		modifier = {
			factor = 2
			galaxy_percentage > 0.2
		}
		modifier = {
			factor = 0
			count_playable_country = {
				count > 1
				limit = {
					has_ascension_perk = ap_become_the_crisis
				}
			}
		}
		modifier = {
			factor = 0
			blocks_disruptive_gameplay = yes
		}
	}
}
ap_behemoths = {
	potential = {
		has_biogenesis_dlc = yes
		NOR = {
			has_ascension_perk = ap_become_the_crisis
			has_ascension_perk = ap_cosmogenesis
			has_ascension_perk = ap_behemoths
			has_ascension_perk = ap_gts_115tiny_crisis
			has_ascension_perk = ap_defender_of_the_galaxy
			has_origin = origin_slavers # No crisis for MSI
			is_wilderness_empire = yes
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_ascension_perks_3"
			num_ascension_perks > 2
		}
		custom_tooltip = {
			fail_text = "requires_independence"
			is_subject = no
		}
		custom_tooltip = {
			fail_text = "must_not_be_custodian"
			is_galactic_custodian = no
		}
		custom_tooltip = {
			fail_text = "must_not_be_emperor"
			is_galactic_emperor = no
		}
		custom_tooltip = {
			fail_text = "must_use_bioships"
			country_uses_bio_ships = yes
		}
		NOR = {
			has_ethic = ethic_xenophile
			has_ethic = ethic_fanatic_xenophile
			has_ethic = ethic_pacifist
			has_ethic = ethic_fanatic_pacifist
		}
	}

	on_enabled = {
		activate_crisis_progression = behemoth_path
	}

	ai_weight = {
		factor = 7.5
		modifier = {
			factor = 0
			is_xenophile = yes
			is_spiritualist = yes
		}

		modifier = {
			factor = 0.5
			is_lithoid = yes
		}

		modifier = {
			factor = 4
			is_homicidal = yes
		}

		modifier = {
			factor = 6
			has_civic = civic_hive_devouring_swarm
		}

		modifier = {
			factor = 2
			has_tradition = tr_enmity_finish
		}
		modifier = {
			factor = 2
			has_ascension_perk = ap_engineered_evolution
		}
		modifier = {
			factor = 2
			has_ascension_perk = ap_nihilistic_acquisition
		}
		modifier = {
			factor = 10
			has_country_flag = eater_covenant_confirmed
		}
		modifier = {
			factor = 0
			galaxy_percentage < 0.1
		}
		modifier = {
			factor = 2
			galaxy_percentage > 0.2
		}
	}
}

