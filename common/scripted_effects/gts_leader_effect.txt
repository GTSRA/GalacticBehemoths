#传说巨娘与小人领袖创建
legendary_gts_leader_creator = {
	create_country = {
		name = "NAME_leader_country"
		type = faction
		auto_delete = yes
		flag = {
			icon = {
				category = "special"
				file = "unknown.dds"
			}
			background = {
				category = "backgrounds"
				file = "00_solid.dds"
			}
			colors = {
				"red"
				"red"
				"null"
				"null"
			}
		}
		effect = {
			save_event_target_as = leader_country
		}
	}
	event_target:leader_country = {
		create_species = {
			name = GTS_LEADER_SPECIES
			class = MAM
			portrait = $LEADER_PORTRAIT$
			traits = {
				trait = "trait_enduring"
			}
			allow_negative_traits = no
			effect = {
				save_event_target_as = gts_leader_species
			}
			gender = female
		}
		create_leader = {
			class = $CLASS$
			species = event_target:gts_leader_species
			name = $NAME$
			skill = $LEVEL$
			gender = $GENDER$
			event_leader = $EVENT_LEADER$ # Leader is allowed to lead factions and win elections
			background_ethic = ethic_$ETHIC$
			skip_background_generation = yes
			custom_description = $DESC$
			custom_catch_phrase = $CATCH_PHRASE$
			immortal = $IMMORTAL$
			hide_age = no
			set_age = $AGE$
			randomize_traits = $RANDOMIZE_TRAITS$
			effect = {
				set_skill = $LEVEL$
				save_event_target_as = gts_leader
				set_leader_flag = legendary_leader
				set_leader_flag = leader_death_events_blocked
				save_global_event_target_as = $TARGET$
				set_leader_flag = $TARGET$
				[[IS_FUTA]
					set_leader_flag = is_futa_leader
				]
				[[IS_SCAT]
					set_leader_flag = is_scat_leader
				]
				[[!IS_CRUEL]
					set_leader_flag = is_kind_leader
				]
				[[!IS_KIND]
					set_leader_flag = is_cruel_leader
				]
				[[TRAIT1]
				add_trait = {
			        trait = $TRAIT1$
			        show_message = no
		        }]
				[[TRAIT2]
				add_trait = {
			        trait = $TRAIT2$
			        show_message = no
		        }]
				[[TRAIT3]
				add_trait = {
			        trait = $TRAIT3$
			        show_message = no
		        }]
				[[TRAIT4]
				add_trait = {
			        trait = $TRAIT4$
			        show_message = no
		        }]
				[[TRAIT5]
				add_trait = {
			        trait = $TRAIT5$
			        show_message = no
		        }]
				[[TRAIT6]
				add_trait = {
			        trait = $TRAIT6$
			        show_message = no
		        }]

			}
		}
	}
	event_target:gts_leader = {
		set_owner = root
		# This is a hack to make the leader not be added to player country.
		# We must call ethic_leader_hire on the hire event
		# We must call ethic_leader_kill on the dismiss event
		exile_leader_as = ethic_leader_exile
	}
}
legendary_tiny_leader_creator = {
	create_country = {
		name = "NAME_leader_country"
		type = faction
		auto_delete = yes
		flag = {
			icon = {
				category = "special"
				file = "unknown.dds"
			}
			background = {
				category = "backgrounds"
				file = "00_solid.dds"
			}
			colors = {
				"red"
				"red"
				"null"
				"null"
			}
		}
		effect = {
			save_event_target_as = leader_country
		}
	}
	event_target:leader_country = {
		create_species = {
			name = TINY_LEADER_SPECIES
			class = MAM
			portrait = $LEADER_PORTRAIT$
			traits = {
				trait = "trait_enduring"
			}
			allow_negative_traits = no
			effect = {
				save_event_target_as = gts_leader_species
			}
			gender = female
		}
		create_leader = {
			class = $CLASS$
			species = event_target:gts_leader_species
			name = $NAME$
			skill = $LEVEL$
			gender = $GENDER$
			event_leader = no # Leader is allowed to lead factions and win elections
			background_ethic = ethic_$ETHIC$
			skip_background_generation = yes
			custom_description = $DESC$
			custom_catch_phrase = $CATCH_PHRASE$
			immortal = $IMMORTAL$
			hide_age = no
			set_age = $AGE$
			randomize_traits = $RANDOMIZE_TRAITS$
			effect = {
				set_skill = $LEVEL$
				save_event_target_as = gts_leader
				set_leader_flag = legendary_leader
				set_leader_flag = leader_death_events_blocked
				save_global_event_target_as = $TARGET$
				set_leader_flag = $TARGET$
				[[IS_FUTA]
					set_leader_flag = is_futa_leader
				]
				[[IS_SCAT]
					set_leader_flag = is_scat_leader
				]
				[[!IS_CRUEL]
					set_leader_flag = is_kind_leader
				]
				[[!IS_KIND]
					set_leader_flag = is_cruel_leader
				]
				[[TRAIT1]
					add_trait = {
						trait = $TRAIT1$
						show_message = no
					}]
				[[TRAIT2]
					add_trait = {
						trait = $TRAIT2$
						show_message = no
					}]
				[[TRAIT3]
					add_trait = {
						trait = $TRAIT3$
						show_message = no
					}]
				[[TRAIT4]
					add_trait = {
						trait = $TRAIT4$
						show_message = no
					}]
				[[TRAIT5]
					add_trait = {
						trait = $TRAIT5$
						show_message = no
					}]
				[[TRAIT6]
					add_trait = {
						trait = $TRAIT6$
						show_message = no
					}]
			}
		}		
	}
	event_target:gts_leader = {
		set_owner = root
		# This is a hack to make the leader not be added to player country.
		# We must call ethic_leader_hire on the hire event
		# We must call ethic_leader_kill on the dismiss event
		exile_leader_as = ethic_leader_exile
	}
}
legendary_gts_leader_hire_effect = {
	add_modifier = {
		modifier = gts_leader_upkeep_add
	}
	event_target:gts_leader = {
		set_leader_flag = hired_gts_leader
		set_owner = root
		add_trait = {
			trait = gts_leader_item_i_all
			show_message = no
		}
		gts_ui_leader_init = yes
	}
	create_message = {
		type = MESSAGE_RECRUITED_LEADER
		localization =  MESSAGE_RECRUITED_LEADER_DESC
		days = @toast_message_days
		target = event_target:gts_leader
		variable = {
			type = name
			localization = LEADER
			scope = event_target:gts_leader
		}
		variable = {
			key = "border"
			value = "GFX_border_legendary" #"GFX_border_veteran"
		}
	}
}

#杰出巨娘与小人领袖创建
renowned_gts_leader_creator = {
	create_country = {
		name = "NAME_leader_country"
		type = faction
		auto_delete = yes
		flag = {
			icon = {
				category = "special"
				file = "unknown.dds"
			}
			background = {
				category = "backgrounds"
				file = "00_solid.dds"
			}
			colors = {
				"red"
				"red"
				"null"
				"null"
			}
		}
		effect = {
			save_event_target_as = leader_country
		}
	}
	event_target:leader_country = {
		create_species = {
			name = GTS_LEADER_SPECIES
			class = MAM
			portrait = $LEADER_PORTRAIT$
			traits = {
				trait = "trait_enduring"
			}
			allow_negative_traits = no
			effect = {
				save_event_target_as = gts_leader_species
			}
			gender = female
		}
		create_leader = {
			class = $CLASS$
			species = event_target:gts_leader_species
			name = $NAME$
			skill = $LEVEL$
			gender = $GENDER$
			event_leader = $EVENT_LEADER$ # Leader is allowed to lead factions and win elections
			background_ethic = ethic_$ETHIC$
			skip_background_generation = yes
			custom_description = $DESC$
			custom_catch_phrase = $CATCH_PHRASE$
			immortal = $IMMORTAL$
			hide_age = no
			set_age = $AGE$
			randomize_traits = $RANDOMIZE_TRAITS$
			effect = {
				set_skill = $LEVEL$
				save_event_target_as = gts_leader
				set_leader_flag = renowned_leader
				set_leader_flag = leader_death_events_blocked
				save_global_event_target_as = $TARGET$
				set_leader_flag = $TARGET$
				[[IS_FUTA]
					set_leader_flag = is_futa_leader
				]
				[[IS_SCAT]
					set_leader_flag = is_scat_leader
				]
				[[!IS_CRUEL]
					set_leader_flag = is_kind_leader
				]
				[[!IS_KIND]
					set_leader_flag = is_cruel_leader
				]
				[[TRAIT1]
					add_trait = {
						trait = $TRAIT1$
						show_message = no
					}]
				[[TRAIT2]
					add_trait = {
						trait = $TRAIT2$
						show_message = no
					}]
				[[TRAIT3]
					add_trait = {
						trait = $TRAIT3$
						show_message = no
					}]
				[[TRAIT4]
					add_trait = {
						trait = $TRAIT4$
						show_message = no
					}]
				[[TRAIT5]
					add_trait = {
						trait = $TRAIT5$
						show_message = no
					}]
				[[TRAIT6]
					add_trait = {
						trait = $TRAIT6$
						show_message = no
					}]
			}
		}		
	}
	event_target:gts_leader = {
		set_owner = root
		# This is a hack to make the leader not be added to player country.
		# We must call ethic_leader_hire on the hire event
		# We must call ethic_leader_kill on the dismiss event
		exile_leader_as = ethic_leader_exile
	}
}
renowned_tiny_leader_creator = {
	create_country = {
		name = "NAME_leader_country"
		type = faction
		auto_delete = yes
		flag = {
			icon = {
				category = "special"
				file = "unknown.dds"
			}
			background = {
				category = "backgrounds"
				file = "00_solid.dds"
			}
			colors = {
				"red"
				"red"
				"null"
				"null"
			}
		}
		effect = {
			save_event_target_as = leader_country
		}
	}
	event_target:leader_country = {
		create_species = {
			name = TINY_LEADER_SPECIES
			class = MAM
			portrait = $LEADER_PORTRAIT$
			traits = {
				trait = "trait_enduring"
			}
			allow_negative_traits = no
			effect = {
				save_event_target_as = gts_leader_species
			}
			gender = female
		}
		create_leader = {
			class = $CLASS$
			species = event_target:gts_leader_species
			name = $NAME$
			skill = $LEVEL$
			gender = $GENDER$
			event_leader = $EVENT_LEADER$ # Leader is allowed to lead factions and win elections
			background_ethic = ethic_$ETHIC$
			skip_background_generation = yes
			custom_description = $DESC$
			custom_catch_phrase = $CATCH_PHRASE$
			immortal = $IMMORTAL$
			hide_age = no
			set_age = $AGE$
			randomize_traits = $RANDOMIZE_TRAITS$
			effect = {
				set_skill = $LEVEL$
				save_event_target_as = gts_leader
				set_leader_flag = renowned_leader
				set_leader_flag = leader_death_events_blocked
				save_global_event_target_as = $TARGET$
				set_leader_flag = $TARGET$
				[[IS_FUTA]
					set_leader_flag = is_futa_leader
				]
				[[IS_SCAT]
					set_leader_flag = is_scat_leader
				]
				[[!IS_CRUEL]
					set_leader_flag = is_kind_leader
				]
				[[!IS_KIND]
					set_leader_flag = is_cruel_leader
				]
				[[TRAIT1]
					add_trait = {
						trait = $TRAIT1$
						show_message = no
					}]
				[[TRAIT2]
					add_trait = {
						trait = $TRAIT2$
						show_message = no
					}]
				[[TRAIT3]
					add_trait = {
						trait = $TRAIT3$
						show_message = no
					}]
				[[TRAIT4]
					add_trait = {
						trait = $TRAIT4$
						show_message = no
					}]
				[[TRAIT5]
					add_trait = {
						trait = $TRAIT5$
						show_message = no
					}]
				[[TRAIT6]
					add_trait = {
						trait = $TRAIT6$
						show_message = no
					}]
			}
		}		
	}
	event_target:gts_leader = {
		set_owner = root
		# This is a hack to make the leader not be added to player country.
		# We must call ethic_leader_hire on the hire event
		# We must call ethic_leader_kill on the dismiss event
		exile_leader_as = ethic_leader_exile
	}
}
renowned_gts_leader_hire_effect = {
	add_modifier = {
		modifier = gts_leader_upkeep_add
	}
	event_target:gts_leader = {
		set_leader_flag = hired_gts_leader
		set_owner = root
		add_trait = {
			trait = gts_leader_item_i_all
			show_message = no
		}
		gts_ui_leader_init = yes
	}
	create_message = {
		type = MESSAGE_RECRUITED_LEADER
		localization =  MESSAGE_RECRUITED_LEADER_DESC
		days = @toast_message_days
		target = event_target:gts_leader
		variable = {
			type = name
			localization = LEADER
			scope = event_target:gts_leader
		}
		variable = {
			key = "border"
			value = "GFX_border_veteran"
		}
	}
}

#给附庸的领袖上特质
add_ultracompany_leader_trait = {
	random_list = {
		1 = { 
			add_trait = {
				trait = leader_trait_ultracompany_asset 
				show_message = no
			} 
		}
	}
}
seele_random_event = {
	random_list = {
		1 = {
			country_event = {
				id = gts_seele.74
			}
		}
		1 = {
			country_event = {
				id = gts_seele.75
			}
		}
		1 = {
			country_event = {
				id = gts_seele.76
			}
		}
		1= {
			country_event = {
				id = gts_seele.77
			}
		}
		1= {
			country_event = {
				id = gts_seele.92
			}
		}
		1= {
			random_list = {
				1 = {
					if = {
						limit = {
							has_country_flag = seele_fenkai
						}
					}
					country_event = {
						id =gts_seele.95
					}
				}
				0 = {
					country_event = {
						id = gts_seele.93#没有
					}
				}
				1 = {
					if = {
						limit = {
							has_country_flag = hire_bronya
						}
					}
					country_event = {
						id =gts_seele.96
					}
				}
			}
		}

	}
}


# 仅用于千海事件链中
# this = country
remove_gts_qhai_conflag = {
	remove_country_flag = gts_leader_qhai_con
	remove_country_flag = gts_leader_qhai_con2
	remove_country_flag = gts_leader_qhai_con3
}

gts_planet_job_add = {
}

create_firefly_warship = {
	create_ship = {
		name = "NAME_firefly_Warship"
		design = "NAME_firefly_Warship"
		prefix = no
		upgradable = no
	}
}

create_firefly_army = {
	create_army_transport = {
		ship_name = "NAME_firefly_army"
		army_name = "gts_firefly_army"
		army_type = "gts_firefly_army"
	}
}

gts_yarong_rebirth_effect = {
	while = {
		count = 10
		random_owned_pop_group = {
			kill_all_pop = yes
		}
	}
}

# 计算指定月数的能量币
gts_qhai_energy_count = {
	add_monthly_resource_mult = {
		resource = energy
		value = $COUNT|1$
	}
}

gts_qhai_unity_count = {
	add_monthly_resource_mult = {
		resource = unity
		value = $COUNT|1$
	}
}

skadi_hire_leader = {
	event_target:ethic_leader = {
		set_owner = root
		set_leader_flag = gts_skadi
		#set_leader_flag = legendary_leader #renowed为名声在外
		#set_leader_flag = hired_admiral_merc_leader领袖不计入上限
		set_leader_flag = should_not_have_upkeep		#没有维护费
		add_skill_without_trait_selection = 10
		save_global_event_target_as = gts_skadi		#全球事件都能用
		gts_ui_leader_init = yes
	}
	create_message = {
		#弹信息
		type = MESSAGE_RECRUITED_LEADER
		localization = MESSAGE_RECRUITED_LEADER_DESC
		days = @toast_message_days
		target = event_target:gts_skadi
		variable = {
			type = name
			localization = LEADER
			scope = event_target:gts_skadi
		}
		variable = {
			key = "border"
			value = "GFX_border_legendary"
		}
	}
}

#拒绝伊莎玛拉随便弹个事件
isharmla_dislike_event = {
	event_target:skadi_country = {
		random_list = {
			20 = {
				country_event = {
					id = gts_skadi_shroud.0002
				}
			}
			20 = {
				country_event = {
					id = gts_skadi_shroud.0003
				}
			}
			10 = {
				country_event = {
					id = gts_skadi_shroud.0004
				}
			}
			20 = {
				country_event = {
					id = gts_skadi_shroud.0005
				}
			}
			20 = {
				country_event = {
					id = gts_skadi_shroud.0006
				}
			}
		}
	}
}

#斯卡蒂给灵能的时候弹消息
create_skadi_give_massage = {
	create_message = {
		type = MESSAGE_skadi_give_psionic
		localization = $localization$
		days = 30
		target = this
		variable = {
			type = name
			localization = LEADER
			scope = this
		}
		variable = {
			type = name
			localization = LEADER_TRAITS
			scope = this
		}
	}
}

#卡池抽干了随机一个事件
skadi_traits_random_event = {
	random_list = {
		1 = {
			country_event = {
				id = gts_skadi_traits.00
			}
		}
		1 = {
			country_event = {
				id = gts_skadi_traits.99
			}
		}
	}
}

#创建希诺舰队
create_xinuo_fleet = {
	event_target:gts_xinuo = {
		hidden_effect = {
			remove_gts_leader_size_trait = yes
		}
		add_trait = {
			trait = leader_trait_Ultra
			show_message = yes
		}
		add_trait = {
			trait = xinuo_leader_trait_greedy
			show_message = yes
		}
	}
	create_fleet = {
		name = "NAME_xinuo_leader"
		effect = {
			create_ship = {
				name = "NAME_xinuo_leader"
				design = "NAME_xinuo_leader"
				effect = {
					set_ship_flag = gts_xinuo_ship
					set_ship_flag = gts_body_ship
					save_global_event_target_as = gts_xinuo_ship
					set_disabled = no
				}
			}
			set_owner = root
			save_global_event_target_as = gts_xinuo_fleet
			set_location = {
				target = Root.capital_scope
				distance = 10
				angle = 90
				direction = in_system
			}
			set_fleet_stance = passive
			set_aggro_range_measure_from = self
			set_aggro_range = 350
			set_leader = event_target:gts_xinuo
		}
		settings = {
			spawn_debris = yes
			is_boss = no
			can_change_leader = no
			uses_naval_capacity = no
			can_upgrade = no
			can_disband = no
			can_change_composition = no
		}
	}
}

#删除希诺舰队
delete_xinuo_fleet = {
	event_target:gts_xinuo = {
		hidden_effect = {
			unassign_leader = this
			remove_gts_leader_size_trait = yes
		}
		add_trait = {
			trait = leader_trait_Normal
			show_message = yes
		}
		add_trait = {
			trait = xinuo_leader_trait_feather
			show_message = yes
		}
	}
	event_target:gts_xinuo_ship = {
		delete_ship = this
	}
}

